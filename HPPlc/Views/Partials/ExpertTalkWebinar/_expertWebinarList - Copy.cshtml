@inherits Umbraco.Web.Mvc.UmbracoViewPage<HPPlc.Models.ExpertTalkWebinar.ExpertTalkWebinarModel>
@using HPPlc.Models.ExpertTalkWebinar;
@{
	var model = Model;
	var titleData = Umbraco?.ContentAtRoot()?.FirstOrDefault()?.Children?
		.Where(x => x.ContentType.Alias == "expertTalks").OfType<ExpertTalks>().FirstOrDefault();

}
@if (model != null && Model.ExpertWebinars != null && Model.ExpertWebinars.Any())
{
	<div class="list-items dvExpertWiseContainer">
		@foreach (WebinarItems item in Model.ExpertWebinars)
		{
			<div class="item-col">
				<div class="card-box">
					<div class="card-img">
						<img src="@item.ImagesSrc" alt="Webinar Image" />
					</div>
					<div class="card-cont">
						<div class="card-dscptn">
							<div class="card-title">
								<strong>@titleData.TopicTitle :</strong> @item.Topic
							</div>
							<div class="card-title">
								<strong>@titleData.SpeakerTitle:</strong> @Html.Raw(item.Speaker)
							</div>
							<div class="card-title">
								<strong>
									@titleData.DateTitle:
								</strong> @Convert.ToDateTime(item.WebinarDate).ToString("dd MMM yyy") @Convert.ToDateTime(item.WebinarStartTime).ToString("hh:mm tt") - @Convert.ToDateTime(item.WebinarEndTime).ToString("hh:mm tt")
							</div>
							@{
								DateTime dt = DateTime.Parse(DateTime.Now.ToString());
								var currentTime = dt.ToString("HH:mm");
								var WebinarDate = Convert.ToDateTime(item.WebinarDate);

								var webinarStartTime = Convert.ToDateTime(item.WebinarStartTime).ToString("HH:mm");
								var webinarEndTime = Convert.ToDateTime(item.WebinarEndTime).ToString("HH:mm");

								//var webinarAppearTime = TimeSpan.Parse(webinarStartTime).TotalMinutes - Convert.ToDouble(item.JoinNowDisplayInMinutes);
								//var webinarRegisterTime = TimeSpan.Parse(webinarStartTime).TotalMinutes - Convert.ToDouble(item.AppearRegisterNowInMinutes);

								DateTime WebinarStartDateTime = Convert.ToDateTime(WebinarDate).Add(TimeSpan.Parse(webinarStartTime.ToString()));
								DateTime WebinarEndDateTime = Convert.ToDateTime(WebinarDate).Add(TimeSpan.Parse(webinarEndTime.ToString()));
								DateTime JoinNowButtonDisplayDateTime = WebinarStartDateTime.AddMinutes(-item.JoinNowDisplayInMinutes);
								DateTime RegisterButtonDisplayDateTime = WebinarStartDateTime.AddMinutes(-item.AppearRegisterNowInMinutes);


								//TimeSpan registerTime = TimeSpan.FromMinutes(webinarRegisterTime);
								//string registerTimeValue = registerTime.ToString(@"hh\:mm");


								//TimeSpan appearTime = TimeSpan.FromMinutes(webinarAppearTime);
								//string appearTimeValue = appearTime.ToString(@"hh\:mm");

								//var webinarDisAppearTime = TimeSpan.Parse(webinarStartTime).TotalMinutes - Convert.ToDouble(item.DisAppearJoinNowInMinutes);
								//TimeSpan disAppearTime = TimeSpan.FromMinutes(webinarDisAppearTime);
								//string disAppearTimeValue = disAppearTime.ToString(@"hh\:mm");

								if (WebinarEndDateTime > dt)
								{
									<div class='btn-col'>
										<a href='@item.WebinarLink' target='_blank' class='btn'>@titleData.RegisterNow</a>
									</div>
									//Join Now Button Display
									@*if (dt >= JoinNowButtonDisplayDateTime)
				{
					<div class='btn-col'>
						<a href='@item.WebinarLink' target='_blank' class='btn'>@titleData.JoinNow</a>
					</div>
				}*@
									//Registration Button Display
									//else if (dt >= RegisterButtonDisplayDateTime)
									//{
									//	<div class='btn-col'>
									//		<a href='@item.WebinarLink' target='_blank' class='btn'>@titleData.RegisterNow</a>
									//	</div>
									//}
									//		else if (dt > WebinarEndDateTime)
									//		{
									//	<div class='btn-col'>
									//		<a href='javascript:void(0);' class='btn'>@titleData.WebinarExpired</a>
									//	</div>
									//}
									@*else
				{
					if (Convert.ToDateTime(currentTime) >= Convert.ToDateTime(appearTimeValue))
					{
						if (Convert.ToDateTime(currentTime) <= Convert.ToDateTime(disAppearTimeValue))
						{
							<div class='btn-col'>
								<a href='@item.WebinarLink' target='_blank' class='btn'>@titleData.JoinNow</a>
							</div>
						}
					}
				}*@
									//}
									//else
									//{
									@*if (Convert.ToDateTime(webinarEndTime) <= Convert.ToDateTime(currentTime) && Convert.ToDateTime(webinarEndTime) <= Convert.ToDateTime(currentTime))
				{
					<div class='btn-col'>
						<a href='javascript:void(0);' class='btn'>@titleData.WebinarExpired</a>
					</div>
				}*@
									//			else if (Convert.ToDateTime(webinarStartTime) <= Convert.ToDateTime(currentTime) && Convert.ToDateTime(webinarEndTime) >= Convert.ToDateTime(currentTime))
									//{
									//				< div class='btn-col'>
									//					<a href = 'javascript:void(0);' class='btn'>@titleData.JoinNow</a>
									//				</div>
									//			}
								}
								else
								{
									<div class='btn-col'>
										<a href='javascript:void(0);' class='btn'>@titleData.WebinarExpired</a>
									</div>
								}
							}
						</div>
					</div>
				</div>
			</div>
		}
	</div>
}